    <script type="text/javascript">
      $(document).ready(function () {
        $('#upload_datafile').focus();
      });
    </script>
    <% #debugger
       if !@error && @df && @user.id == @df.creator_id %>
    <header>
    File saved under token <%= @df.token_id %> [<a href="http://<%= koin_host %><%= koin_port == '80' ? '' : ':' + koin_port %>/token/<%= @df.token_id %>">link</a>]
    </header>
    <% else %>                                
      <% if @token %>
      <header>
        Token <%= @token %> not found or permission not granted
      </header>       
      <% end %>
      <% if @error %>
      <header>
        Command failed: <%= @error %>
      <header>
      <% end %>
    <% end %>
    <div class="spacer">
    </div>
    <div>
    <%= form_for(@df, :url => {controller: 'koin', action: 'uploadFile'}) do |f| %>
        <p><label for="upload_file">Select File</label>: 
        <%= f.file_field :upload %></p>
        <% if !@guest %>
        Allow downloads for this file from:<br />
        <%= f.radio_button :p_permissions, 'me' %>Only Me<br />
        <%= f.radio_button :p_permissions, 'anyone', checked: true %>Anyone<br />
        <%= f.radio_button :p_permissions, 'users' %>Any Logged In User<br />
        <%= f.radio_button :p_permissions, 'specific_users' %>These Users:
        <%= select_tag 'users[selected][]', options_from_collection_for_select(@users, 'id', 'username'), { :multiple => true, :size =>5, :id => "users_selected" } %><br />
        <% end %>
        Subject: <%= f.text_field :subject %><br />
        Description: <%= f.text_area :description, :rows => 5, :cols => 20 %><br />
        Optional Password: <%= f.password_field :pass %><br />
        Optional Expiration: <%= f.text_field :expiration %><emphasis>(YYYY-MM-DD HH:MM:SS)</emphasis><br />
        <%= submit_tag "Upload" %>
      <% end %>
    </div>

